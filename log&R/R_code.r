# ---------------------------------------------------
# 1. 데이터프레임 생성 (사용자가 직접 데이터 입력)
# ---------------------------------------------------

A <- c(0,0,0,1,0,0,0,0,0,0,1,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)
B <- c(0,0,0,0,1,1,1,0,0,1,1,1,0,1,0,0,1,0,0,1,0,0,0,0,0,0,1,0,0,0,1,0,0,1,0,1,0,1,0,0,0,0,0,0,0,0,1,0)
C <- c(1,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,0,0,1,0,0,0,0,0,1,0,0,0,1,0,0,0,1,0,0,0,0,1,0,0,0,0)
D <- c(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,1,0,0,1,0,0,0,0,0,0,0,0,0,0,0,0,0,0)

df <- data.frame(A, B, C, D)

# ---------------------------------------------------
# 2. 성공률 계산
# ---------------------------------------------------

success_rates <- data.frame(
  Path = c("A", "B", "C", "D"),
  SuccessRate = c(mean(df$A), mean(df$B), mean(df$C), mean(df$D))
)

# ---------------------------------------------------
# 3. 그래프 생성
# ---------------------------------------------------

library(ggplot2)

ggplot(success_rates, aes(x = Path, y = SuccessRate, fill = Path)) +
  geom_col(width = 0.6) +
  geom_text(aes(label = scales::percent(SuccessRate, accuracy = 1)),
            vjust = -0.3, size = 5) +
  scale_y_continuous(
    labels = scales::percent_format(accuracy = 1),
    limits = c(0, max(success_rates$SuccessRate) * 1.2)
  ) +
  labs(
    title = "경로 A/B/C/D 성공률 비교",
    x = "경로",
    y = "성공률"
  ) +
  theme_minimal() +
  theme(text = element_text(size = 14))

